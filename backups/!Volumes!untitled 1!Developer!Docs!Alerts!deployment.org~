#+TITLE: Deploying Alerts
#+SETUPFILE: https://fniessen.github.io/org-html-themes/setup/theme-readtheorg.setup

** Create instance
Follow the instruction on [[https://docs.aws.amazon.com/quickstarts/latest/vmlaunch/step-1-launch-instance.html][this]] page to launch the instance.
=1. Choose an Amazon Machine Image= select an appropriate ~Ubuntu~ instance (preferable ~16.04~). On
=2. Choose an Instance Type= select =C5.4x large=
Follow the rest of the steps as listed and launch the instance

** Create and mount volume
+ Create a new ~80GB~ [[https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSVolumeTypes.html][general purpose SSD (gp2)]] and [[https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-attaching-volume.html][attach]] to the instance just created
+ [[https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-using-volumes.html][format and mount]] the volume

** Install docker and compose
+ Install [[https://docs.docker.com/install/linux/docker-ce/ubuntu/][docker]] and [[https://docs.docker.com/compose/install/][docker-compose]]
+ Modify the configs to store all docker data in ~/data~ directory. Follow [[http://forums.docker.com/t/how-do-i-change-the-docker-image-installation-directory/1169][this]] guide.
+ Start the docker engine with the following command ~sudo service start docker~

** Download and Setup code
+ Cd into ~/code~ and create a new folder for the code ~cd /data && mkdir Alerts~
+ Clone the latest code from github master branch
+ Create a new ~.env~ file in the ~/data/Alerts~ folder and setup environment variables. These may vary, depending upon the code. *Make sure there is no whitespace between names and values*. Here is an example ~.env~ file.
#+CAPTION: An example ~.env~ file
#+NAME:   .env
[[./img/env-file.png]]

** Launching Alerts
~sudo docker-compose up -d~ would start all the containers in the background. Remove ~-d~ flag for code to run in the same window
